# Mind the Gap: Assessing Temporal Generalization in Neural Language Models

This repository contains the dataset splits used in
[Mind the Gap: Assessing Temporal Generalization in Neural Language Models](https://arxiv.org/abs/2102.01951)
(Lazaridou, Kuncoro, Gribovskaya et al., 2021).

## Datasets

We provide splits of two public datasets used in the paper:
WMT News Crawl and arXiv abstracts.

Each subset is stored on Google Cloud Storage as gzipped text file specifying publication dates (in the `YYYYMMDD` format) and IDs of documents contained in the subset.

### arXiv

arXiv abstracts and publication dates were obtained through arXiv's [OAI-PMH service](https://arxiv.org/help/oa) on January 2, 2021. We used the value in the `created` field as the article's publication date. The arXiv dataset can also be downloaded from [Kaggle](https://www.kaggle.com/Cornell-University/arxiv).

### WMT

We downloaded document-split versions of the English and German [WMT News Crawl dataset](http://data.statmt.org/news-crawl/README). As the dataset does not provide document IDs, we used SHA256 hashes of the Base64 encoded unsplit texts of articles as their IDs, i.e.:

```python
import gzip
import hashlib

with gzip.open('news-docs.2007.en.filtered.gz', 'rb') as gz_file:
  for line in gz_file:
    date, sentence_split_text, unsplit_text = line.decode('utf-8').strip().split('\t')
    docid = hashlib.sha256(unsplit_text.encode('utf-8')).hexdigest()
    yield docid, (date, sentence_split_text, unsplit_text)
```

We trained models on sentence split article texts. Some articles may appear multiple times in the dataset with different publication dates; we used each article's earliest publication date.


## Splits used in experiments

| Experiments | Dataset | Splits |
|---|:---:|:---:|
| Sections 3-5 | WMT | control: [train](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/time_stratified_control/split_2017-09-30/control_train.gz), [validation](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/time_stratified_control/split_2017-09-30/control_validation.gz) <br /> time-stratified: [train](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/time_stratified_control/split_2017-09-30/time_stratified_train.gz), [validation](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/time_stratified_control/split_2017-09-30/time_stratified_validation.gz) <br /> [test](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/time_stratified_control/split_2017-09-30/test.gz)|
|| arXiv | control: [train](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/arxiv/time_stratified_control/split_2017-09-30/control_train.gz), [validation](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/arxiv/time_stratified_control/split_2017-09-30/control_validation.gz) <br /> time-stratified: [train](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/arxiv/time_stratified_control/split_2017-09-30/time_stratified_train.gz), [validation](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/arxiv/time_stratified_control/split_2017-09-30/time_stratified_validation.gz) <br /> [test](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/arxiv/time_stratified_control/split_2017-09-30/test.gz)|
| Appendix B: The effect of outdated models persists beyond the 2018/2019 test period | WMT | test period 2017/2018: control: [train](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/time_stratified_control/split_2016-09-30/control_train.gz), [validation](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/time_stratified_control/split_2016-09-30/control_validation.gz); time-stratified: [train](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/time_stratified_control/split_2016-09-30/time_stratified_train.gz), [validation](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/time_stratified_control/split_2016-09-30/time_stratified_validation.gz); [test](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/time_stratified_control/split_2016-09-30/test.gz) <br /> test period 2016/2017: control: [train](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/time_stratified_control/split_2015-09-30/control_train.gz), [validation](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/time_stratified_control/split_2015-09-30/control_validation.gz); time-stratified: [train](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/time_stratified_control/split_2015-09-30/time_stratified_train.gz), [validation](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/time_stratified_control/split_2015-09-30/time_stratified_validation.gz); [test](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/time_stratified_control/split_2015-09-30/test.gz) <br /> test period 2015/2016: control: [train](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/time_stratified_control/split_2014-09-30/control_train.gz), [validation](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/time_stratified_control/split_2014-09-30/control_validation.gz); time-stratified: [train](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/time_stratified_control/split_2014-09-30/time_stratified_train.gz), [validation](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/time_stratified_control/split_2014-09-30/time_stratified_validation.gz); [test](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/time_stratified_control/split_2014-09-30/test.gz) <br /> test period 2014/2015: control: [train](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/time_stratified_control/split_2013-09-30/control_train.gz), [validation](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/time_stratified_control/split_2013-09-30/control_validation.gz); time-stratified: [train](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/time_stratified_control/split_2013-09-30/time_stratified_train.gz), [validation](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/time_stratified_control/split_2013-09-30/time_stratified_validation.gz); [test](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/time_stratified_control/split_2013-09-30/test.gz) <br /> test period 2013/2014: control: [train](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/time_stratified_control/split_2012-09-30/control_train.gz), [validation](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/time_stratified_control/split_2012-09-30/control_validation.gz); time-stratified: [train](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/time_stratified_control/split_2012-09-30/time_stratified_train.gz), [validation](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/time_stratified_control/split_2012-09-30/time_stratified_validation.gz); [test](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/time_stratified_control/split_2012-09-30/test.gz) |
| Appendix C: The effect of outdated models persists beyond the two-year gap | WMT | test: same as the one for Sections 3-5 <br /> validation: same as the one for the time-stratified setup for Sections 3-5 <br /> train until: [2017-09-30](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/increasing_distance/split_2017-09-30/train.gz), [2017-03-31](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/increasing_distance/split_2017-03-31/train.gz), [2016-09-30](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/increasing_distance/split_2016-09-30/train.gz), [2016-03-31](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/increasing_distance/split_2016-03-31/train.gz), [2015-09-30](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/increasing_distance/split_2015-09-30/train.gz), [2015-03-31](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/increasing_distance/split_2015-03-31/train.gz), [2014-09-30](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/increasing_distance/split_2014-09-30/train.gz), [2014-03-31](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/increasing_distance/split_2014-03-31/train.gz), [2013-09-30](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/increasing_distance/split_2013-09-30/train.gz), [2013-03-31](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/increasing_distance/split_2013-03-31/train.gz), [2012-09-30](https://storage.googleapis.com/deepmind-pitfalls-static-language-models/wmt/increasing_distance/split_2012-09-30/train.gz)
